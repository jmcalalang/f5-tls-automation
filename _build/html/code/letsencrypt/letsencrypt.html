<!DOCTYPE html>
<div id="clouddocs-header">
  <div class="container-fluid">
    <div class="row corp-header">
      <div class="container corp-header">
        <div class="container corp-menu">
          <ul>
            <li><a href="https://f5.com" class="internalLink">F5.com</a></li>
            <li><a href="https://github.com/F5Networks" class="externalLink">GitHub</a></li>
            <li><a href="https://devcentral.f5.com" class="internalLink">Devcentral</a></li>
            <li><a href="https://support.f5.com" class="internalLink">Support</a></li>
          </ul>
        </div>
      </div>
    </div>

    <script async="async"
      src="https://consent.trustarc.com/notice?domain=f5.com&amp;c=teconsent&amp;text=true&amp;gtm=1" crossorigin=""
      id="truste_0.12182038258598205"></script>

    <div class="row pageHeader">
      <div class="container stat">
        <div class="col-xs-12 stat">
          <a class="internalLink" href="https://f5.com">
            <img class="logo" src="https://cdn.f5.com/websites/support/assets/images/logo.svg" width="50" height="44"
              alt="F5 Networks" title="F5 Networks" border="0">
          </a>
          <ul id="MainMenu" class="main-menu">
            <li data-submenu-id="products">
              <a data-link-type="nav: main" href="#" class="currentURL">Products
                <span class="indicator"><span class="arrow-up"></span></span>
              </a>
              <div class="menu-panel soft-hide" id="products-submenu">
                <div class="container">
                  <ul class="submenu">
                    <li>
                      <span class="a-mm-h">BIG-IP Extensibility</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/products/extensions/f5-appsvcs-extension/latest" data-link-type="Nav: Mega">F5
                            Application Services Extension 3</a></li>
                        <li><a href="https://clouddocs.f5.com/products/agc/latest" data-link-type="Nav: Mega">BIG-IP APM Access Guided
                            Configuration</a></li>
                        <li><a href="https://clouddocs.f5.com/products/iapp/iapp-lx/latest" data-link-type="Nav: Mega">iApps LX/iControl LX</a>
                        </li>
                        <li><a href="https://clouddocs.f5.com/products/extensions/f5-declarative-onboarding/latest"
                            data-link-type="Nav: Mega">F5 Declarative Onboarding</a></li>
                        <li><a href="https://clouddocs.f5.com/products/extensions/f5-telemetry-streaming/latest" data-link-type="Nav: Mega">F5
                            Telemetry Streaming</a></li>
                        <li><a href="https://clouddocs.f5.com/products/extensions/f5-cloud-failover/latest" data-link-type="Nav: Mega">F5 Cloud
                            Failover</a></li>
                        <li><a href="https://clouddocs.f5.com/products/extensions/f5-appsvcs-templates/latest/" data-link-type="Nav: Mega">F5
                            Application Services Templates</a></li>
                      </ul>
                    </li>


                    <li class="divider"></li>
                    <li><span class="a-mm-h">Container Ingress Services</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/containers/latest/" data-link-type="Nav: Mega">F5 BIG-IP Controller for
                            Kubernetes/OpenShift</a></li>
                      </ul>
                      <span class="a-mm-h">Network Function Virtualization</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/cloud/nfv/latest" data-link-type="Nav: Mega">F5 VNF Manager</a></li>
                      </ul>
                      <span class="a-mm-h">SDK</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/sdk/f5-cli" target="_blank">F5 CLI</a></li>
                        <li><a href="https://clouddocs.f5.com/sdk/f5-sdk-python" target="_blank">F5 SDK Python</a></li>
                      </ul>
                    </li>



                    <li class="divider"></li>
                    <li>
                      <span class="a-mm-h">OpenStack</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/products/openstack/agent/latest" data-link-type="Nav: Mega">F5 Agent - OpenStack
                            Neutron</a></li>
                        <li><a href="https://clouddocs.f5.com/products/openstack/lbaasv2-driver/latest" data-link-type="Nav: Mega">F5 Driver -
                            OpenStack LBaaS</a></li>
                        <li><a href="https://clouddocs.f5.com/products/openstack/heat-plugins/latest" data-link-type="Nav: Mega">F5 Plugins -
                            OpenStack Heat</a></li>
                      </ul>

                      <span class="a-mm-h">Ecosystems Integrations</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/f5-aci-servicecenter/latest" data-link-type="Nav: Mega">F5 ACI ServiceCenter</a>
                        </li>
                      </ul>


                    </li>
                    <li class="divider"></li>
                    <li><span class="a-mm-h">Orchestration</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/products/orchestration/ansible/devel" target="_blank">F5 Modules for Ansible</a>
                        </li>
                        <li><a href="https://github.com/F5Networks/f5-aws-cloudformation" target="_blank"
                            class="externalLink">F5 Templates for AWS CloudFormation</a> (GitHub)</li>
                        <li><a href="https://github.com/F5Networks/f5-azure-arm-templates" target="_blank"
                            class="externalLink">F5 Templates for Azure ARM</a> (GitHub)</li>
                        <li><a href="https://github.com/F5Networks/f5-google-gdm-templates" target="_blank"
                            class="externalLink">F5 Templates for Google Cloud Deployment Manager</a> (GitHub)</li>
                        <li><a href="https://clouddocs.f5.com/products/templates/openstack-heat/latest" data-link-type="Nav: Mega">F5 Templates
                            for OpenStack Heat</a></li>
                        <li><a href="https://clouddocs.f5.com/products/orchestration/terraform/latest/" data-link-type="Nav: Mega">F5 Resources
                            for Terraform Provider</a></li>
                      </ul>
                    </li>
                  </ul>
                </div>
              </div>
            </li>

            <!--- NEW -->
            <li>
              <a href="#" class="currentURL">APIs
                <span class="indicator"><span class="arrow-up"></span></span>
              </a>

              <div class="menu-panel soft-hide" id="APISubmenu">
                <div class="container">
                  <ul class="submenu">
                    <li>
                      <span class="a-mm-h"></span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/products/big-iq/mgmt-api/latest/" data-link-type="Nav: Mega">F5 BIG-IQ API</a>
                        </li>
                        <li><a href="https://clouddocs.f5.com/api/iapps/">F5 BIG-IP iApps</a></li>
                        <li><a href="https://clouddocs.f5.com/api/irules">F5 BIG-IP iRules API</a></li>
                        <li><a href="https://clouddocs.f5.com/api/irules-lx">F5 BIG-IP iRulesLX API</a></li>
                      </ul>
                    </li>

                    <li class="divider"></li>

                    <li>
                      <span class="a-mm-h"></span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/api/icontrol-rest">F5 BIG-IP iControlREST API</a></li>
                        <li><a href="https://clouddocs.f5.com/api/icontrol-soap/">F5 BIG-IP iControl API</a></li>
                        <li><a href="https://clouddocs.f5.com/api/ihealth/">F5 iHealth API</a></li>
                        <li><a href="https://clouddocs.f5.com/api/tmsh">F5 tmsh scripting API</a></li>
                      </ul>
                    </li>

                  </ul>
                </div>
              </div>
            </li>




            <li>
              <a href="#" class="currentURL">Cloud &amp; Container
                <span class="indicator"><span class="arrow-up"></span></span>
              </a>

              <div class="menu-panel soft-hide" id="ContainersSubmenu">
                <div class="container">
                  <ul class="submenu col-sm-11">
                    <li class="third"><span class="a-mm-h">Cloud Services</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/cloud-services/latest/f5-cloud-services-GS-About.html"
                            data-link-type="Nav: Mega">Get Started</a></li>
                        <li><a href="https://clouddocs.f5.com/cloud-services/latest/f5-cloud-services-Beacon-About.html"
                            data-link-type="Nav: Mega">Beacon</a></li>
                        <li><a href="https://clouddocs.f5.com/cloud-services/latest/f5-cloud-services-DNS-About.html"
                            data-link-type="Nav: Mega">DNS Cloud Service</a></li>
                        <li><a href="https://clouddocs.f5.com/cloud-services/latest/f5-cloud-services-GSLB-About.html"
                            data-link-type="Nav: Mega">DNS Load Balancer Cloud Service</a></li>
                        <li><a href="https://clouddocs.f5.com/cloud-services/latest/f5-cloud-services-Essential.App.Protect-About.html"
                            data-link-type="Nav: Mega">Essential App Protect Service</a></li>
                      </ul>
                    </li>
                    <li class="divider"></li>
                    <li class="third"><span class="a-mm-h">Clouds</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/cloud/public/v1/aws_index.html" data-link-type="Nav: Mega">AWS</a></li>
                        <li><a href="https://clouddocs.f5.com/cloud/public/v1/azure_index.html" data-link-type="Nav: Mega">Azure</a></li>
                        <li><a href="https://clouddocs.f5.com/cloud/public/v1/google_index.html" data-link-type="Nav: Mega">Google Cloud</a>
                        </li>
                        <li><a href="https://clouddocs.f5.com/cloud/openstack/" data-link-type="Nav: Mega">OpenStack</a></li>
                      </ul>
                      <!-- unnecessary right now>
                    <span class="seemore"><a data-link-type="Nav: Mega" href="/cloud/">See all </a></span>
                    <-->
                    </li>
                    <li class="divider"></li>
                    <li class="third"><span class="a-mm-h">Containers</span>
                      <ul>
                        <li><a href="https://clouddocs.f5.com/containers/latest/userguide/kubernetes/" data-link-type="Nav: Mega">Kubernetes</a>
                        </li>
                        <li><a href="https://clouddocs.f5.com/containers/latest/userguide/openshift/" data-link-type="Nav: Mega">OpenShift</a>
                        </li>
                      </ul>
                    </li>
                  </ul>
                </div>
              </div>
            </li>
            <li>
              <a href="#" class="currentURL">Resources
                <span class="indicator"><span class="arrow-up"></span></span>
              </a>
              <div class="menu-panel soft-hide" id="UPCProgramSubmenu">
                <div class="container">
                  <ul class="submenu col-sm-11">
                    <li class="third">
                      <span class="a-mm-h">Downloads</span>
                      <ul>
                        <li><a target="_blank" data-link-type="Nav: Mega" href="https://hub.docker.com/r/f5networks/"
                            class="internalLink externalLink">Docker Hub</a></li>
                        <li><a target="_blank" data-link-type="Nav: Mega"
                            href="https://store.docker.com/images/f5networks-asp"
                            class="internalLink externalLink">Docker Store</a></li>
                      </ul>
                      <span class="a-mm-h">OpenSource</span>
                      <ul>
                        <li><a target="_blank" data-link-type="Nav: Mega" href="https://github.com/F5Networks"
                            class="internalLink externalLink">F5Networks on GitHub</a></li>
                        <li><a target="_blank" data-link-type="Nav: Mega" href="https://github.com/F5DevCentral"
                            class="internalLink externalLink">F5DevCentral on GitHub</a></li>
                      </ul>
                    </li>
                    <li class="divider"></li>
                    <li class="third">
                      <span class="a-mm-h">Training &amp; Labs</span>
                      <ul>
                        <li>
                          <p>Learn how to get the most out of the F5 platform</p>
                        </li>
                        <li><a href="https://clouddocs.f5.com/training/community">Community</a></li>
                      </ul>
                    </li>
                    <li class="divider"></li>

                    <li class="third">
                      <a href="//university.f5.com" class="a-mm-h internalLink" target="_blank"
                        data-link-type="Nav: Mega">F5 University</a>
                      <ul>
                        <li>
                          <p>Get up to speed with free self-paced courses</p>
                        </li>
                      </ul>
                      <a data-ng-href="https://devcentral.f5.com" class="a-mm-h internalLink" target="_blank"
                        data-link-type="Nav: Mega" href="https://devcentral.f5.com">DevCentral</a>
                      <ul>
                        <li>
                          <p>Join the community of 250,000+ technical peers</p>
                        </li>
                      </ul>
                    </li>
                  </ul>
                </div>
              </div>
            </li>
          </ul>
        </div>

        <div class="col-xs-12 stat">
          <div class="topLinks">
            <span class="glyphicon glyphicon-search upc-search" id="search-toggle" style="display: none;"></span>
          </div>
        </div>
      </div>
    </div>
  </div> <!-- /container-fluid -->
</div>
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BIG-IP - Letsencrypt with F5 Cloudservices DNS &#8212; F5 TLS Automation  documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/f5.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/f5-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/21fb8a09c3.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="BIG-IP - Terraform Provider" href="../terraform/bigipprovider/terraform.html" />
    <link rel="prev" title="BIG-IP - Postman Collection" href="../postman/postman.html" />





  </head><body>
  <div id="clouddocs-header"></div>

    <div id="dismiss">
      <button type="button" class="btn btn-info navbar-btn site-hidden">
        <i class="fa fa-align-justify"></i>
      </button>
    </div>
    <div id="sidebar" class="section-nav">

      <nav class="nav-sidebartoc">


         <h5>F5 TLS Automation  </h5>

<div id="searchbox" role="search">
  <form class="search" action="../../search.html" method="get">
    <input type="text" class="search" name="q" placeholder=" Search..." />
    <button type="submit" class="btn btn-info navbar-btn"><i class="fa fa-search"></i></button>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        <hr>
        <h5>Current Page</h5>
        <span class="nav-sidebartoc">
            <ul>
<li><a class="reference internal" href="#">BIG-IP - Letsencrypt with F5 Cloudservices DNS</a></li>
<li><a class="reference internal" href="#summary">Summary</a></li>
<li><a class="reference internal" href="#steps-of-the-role">Steps of the Role:</a></li>
<li><a class="reference internal" href="#variables-required-for-the-role">Variables required for the role:</a></li>
<li><a class="reference internal" href="#example-playbook">Example playbook</a></li>
<li><a class="reference internal" href="#example-run-command">Example Run command:</a></li>
<li><a class="reference internal" href="#example-ansible-environment">Example Ansible environment:</a></li>
</ul>

         </span>
        <hr>
        <h5>Site Contents</h5>
        <span class="nav-sidebartoc">
            <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ansible/ansible.html">BIG-IP - Ansible Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../postman/postman.html">BIG-IP - Postman Collection</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">BIG-IP - Letsencrypt with F5 Cloudservices DNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="#summary">Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="#steps-of-the-role">Steps of the Role:</a></li>
<li class="toctree-l1"><a class="reference internal" href="#variables-required-for-the-role">Variables required for the role:</a></li>
<li class="toctree-l1"><a class="reference internal" href="#example-playbook">Example playbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="#example-run-command">Example Run command:</a></li>
<li class="toctree-l1"><a class="reference internal" href="#example-ansible-environment">Example Ansible environment:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../terraform/bigipprovider/terraform.html">BIG-IP - Terraform Provider</a></li>
<li class="toctree-l1"><a class="reference internal" href="../venafi/venafi.html">BIG-IP - Venafi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributors.html">Contributions</a></li>
</ul>

        </span><!-- Use this file to add extra links to the bottom of the ToC sidebar -->
<hr>
  <span class="nav-sidebartoc">
 <!-- insert content here -->
  </span>
      </nav>
    </div>


  <div class="main active" id="content">
    <article class="docs-container site-article-inner">
            <nav class="site-breadcrumb-nav site-nav">
          <ul class="site-breadcrumb-list">
            <li class="breadcrumb-item"><button type="button" id="sidebarCollapse" class="btn btn-info navbar-btn site-hidden"><i class="fa fa-align-justify"></i></button>&#x20 <a href="/">F5 TLS Automation</a> &gt; <a href="../../index.html">F5 TLS Automation </a> &gt; BIG-IP - Letsencrypt with F5 Cloudservices DNS</li>
          </ul>
      </nav>



  <div class="section" id="big-ip-letsencrypt-with-f5-cloudservices-dns">
<h1>BIG-IP - Letsencrypt with F5 Cloudservices DNS<a class="headerlink" href="#big-ip-letsencrypt-with-f5-cloudservices-dns" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Tested with Ansible 2.09</p>
</div>
</div>
<div class="section" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h1>
<p>This ansible role provides following functionality:</p>
<ul class="simple">
<li><p>create TLS certificate and key using Letsencrypt as CA</p></li>
<li><p>uses F5 Cloudservices primary DNS offering as validation for domain ownership</p></li>
<li><p>uploads generated certificate and key to a BIG-IP and creates a SSL Client profile with it.</p></li>
</ul>
<p>The rolename is: <strong>f5cs_dns_letsencrypt_bigip</strong></p>
<p>The role can be downloaded from the roles folder here: <a class="reference external" href="https://github.com/jmcalalang/f5-tls-automation/tree/main/code/letsencrypt/roles">Ansible Roles</a>.</p>
</div>
<div class="section" id="steps-of-the-role">
<h1>Steps of the Role:<a class="headerlink" href="#steps-of-the-role" title="Permalink to this headline">¶</a></h1>
<ol class="arabic simple">
<li><p>Checks if certificate already exists in certificate folder. If exists skip subsequent certificate creation steps.</p></li>
<li><p>Create a subdirectory on the ansible host to run and store letsencrypt environment</p>
<ul class="simple">
<li><p>default directory is the <code class="docutils literal notranslate"><span class="pre">{{playbook_dir}}/F5letsencrypt</span></code></p></li>
<li><p>This directory can be changed via variable.</p></li>
</ul>
</li>
<li><p>Create letsencrypt account ID</p>
<ul class="simple">
<li><p>there is a variable that forces the role to create a new Account ID if desired</p></li>
</ul>
</li>
<li><p>Create TLS Certificate signing request</p>
<ul class="simple">
<li><p>the csr is stored in the csr subfolder</p></li>
</ul>
</li>
<li><p>Send API call to Letsencrypt to initiate domain name ownership verification</p>
<ul class="simple">
<li><p>this role uses DNS as verification method.</p></li>
<li><p>per default it is send to Letsencrypt staging envionment, but a variable will instruct it to send it to Letsencrypt production environment.</p></li>
</ul>
</li>
<li><p>Create/modify acme-challenge value into F5 Cloudservices primary DNS entry for existing zone record</p>
<ul class="simple">
<li><p>uses an exisiting F5 Cloudservices account with subscription to primary DNS</p></li>
<li><p>the zone record for the domain name has to exist and be activated prior before the role is run</p></li>
<li><p>creates or modifies the _acme-challenge dns prefix entry for Letsencrypt verification</p></li>
</ul>
</li>
<li><p>Send API call to Letsencrypt to finish domain name ownership verification and download certificate and fullchain certificate</p>
<ul class="simple">
<li><p>finishes letsencrypt verification and download certificate, CA certificate and fullchain certificate into the certs subfolder</p></li>
</ul>
</li>
<li><p>Upload certificate and key into BIG-IP</p>
<ul class="simple">
<li><p>skip this step if <code class="docutils literal notranslate"><span class="pre">send_to_bigip</span></code> does not have the value <code class="docutils literal notranslate"><span class="pre">on</span></code></p></li>
<li><p>login credentials with admin rights must be provides</p></li>
</ul>
</li>
<li><p>Create Client SSL profile in BIG-IP and use uploaded key, certificate and CA</p>
<ul class="simple">
<li><p>installs key, cert and CA cert into BIG-IP and creates a new SSL profile with the cert/key/CAchain</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="variables-required-for-the-role">
<h1>Variables required for the role:<a class="headerlink" href="#variables-required-for-the-role" title="Permalink to this headline">¶</a></h1>
<table class="docutils align-default">
<colgroup>
<col style="width: 28%" />
<col style="width: 49%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>vars</p></th>
<th class="head"><p>description</p></th>
<th class="head"><p>default values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>f5cs_username:</p></td>
<td><p>Username for F5 Cloudservices account</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>f5cs_password:</p></td>
<td><p>Password for F5 Cloudservices account</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>domain_name:</p></td>
<td><p>Domain name for TLS certificate</p></td>
<td></td>
</tr>
</tbody>
</table>
<p>Optional variables</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 41%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>vars</p></th>
<th class="head"><p>description</p></th>
<th class="head"><p>default values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>acme_directory_target:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">prod</span></code> for Letsencrypt production or
<code class="docutils literal notranslate"><span class="pre">staging</span></code> for Letsencrypt staging</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">staging</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>acme_email:</p></td>
<td><p>e-mail address for TSL certificate</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>letsencrypt_dir:</p></td>
<td><p>directory for Letsencrypt files</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">{{playbook_dir}}/F5letsencrypt</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>new_le_account_key:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code> - forces role to
generate a new Letsencrypt account ID</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-even"><td><p>send_to_bigip:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">on</span></code> to send cert/key to BIG-IP
any other value skipps importing of
cert/key into BIG-IP. Good for testing</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">on</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="example-playbook">
<h1>Example playbook<a class="headerlink" href="#example-playbook" title="Permalink to this headline">¶</a></h1>
<p>This is an example playbook for the role.
It assumes the roles folder is under the playbook folder. Please adjust to ansible host environment.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">F5 TLS automation</span>
  <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">localhost</span>
  <span class="nt">connection</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">local</span>
  <span class="nt">gather_facts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

  <span class="nt">vars</span><span class="p">:</span>
    <span class="nt">provider</span><span class="p">:</span>
      <span class="nt">server</span><span class="p">:</span> <span class="s">&#39;bigip.hostname&#39;</span>
      <span class="nt">user</span><span class="p">:</span> <span class="s">&#39;admin&#39;</span>
      <span class="nt">password</span><span class="p">:</span> <span class="s">&#39;bigip_admin_password&#39;</span>
      <span class="nt">validate_certs</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">no</span>
      <span class="nt">server_port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">443</span>
    <span class="nt">partition</span><span class="p">:</span> <span class="s">&#39;Common&#39;</span>
    <span class="nt">state</span><span class="p">:</span> <span class="s">&#39;present&#39;</span>

  <span class="nt">roles</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">roles/f5cs_dns_letsencrypt_bigip</span>
</pre></div>
</div>
<p>This example playbook uploads the certificate and key into a single BIG-IP.
The role can upload the cert/key pair to multiple BIG-IP instances as well.</p>
<p>To upload the key to multiple BIG-IP instances perform followong steps:</p>
<ol class="arabic simple">
<li><p>change the playbook hosts: value to a var group e.g. “bigip_group”</p></li>
</ol>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">F5 TLS automation</span>
  <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bigip_group</span>
  <span class="nt">connection</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">local</span>
  <span class="nt">gather_facts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

  <span class="nt">vars</span><span class="p">:</span>
    <span class="nt">provider</span><span class="p">:</span>
      <span class="nt">server</span><span class="p">:</span> <span class="s">&#39;bigip.hostname&#39;</span>
      <span class="nt">user</span><span class="p">:</span> <span class="s">&#39;admin&#39;</span>
      <span class="nt">password</span><span class="p">:</span> <span class="s">&#39;bigip_admin_password&#39;</span>
      <span class="nt">validate_certs</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">no</span>
      <span class="nt">server_port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">443</span>
    <span class="nt">partition</span><span class="p">:</span> <span class="s">&#39;Common&#39;</span>
    <span class="nt">state</span><span class="p">:</span> <span class="s">&#39;present&#39;</span>

  <span class="nt">roles</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">roles/f5cs_dns_letsencrypt_bigip</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>create a var group with the same name in the hosts :file:</p></li>
</ol>
<div class="highlight-yaml` notranslate"><div class="highlight"><pre><span></span>[bigip_group]
example_bigip1
example_bigip2
</pre></div>
</div>
<p>3. create a host_vars folder and add vars file for each BIG-IP in the “bigip_group”
use following content for each file and adjust the var values accordingly</p>
<div class="highlight-yaml` notranslate"><div class="highlight"><pre><span></span>    provider:
      server: &#39;bigip&#39;
      user: &#39;admin&#39;
      password: &#39;bigip_admin_password&#39;
      validate_certs: no
      server_port: 443
    partition: &#39;Common&#39;
    state: &#39;present&#39;
</pre></div>
</div>
</div>
<div class="section" id="example-run-command">
<h1>Example Run command:<a class="headerlink" href="#example-run-command" title="Permalink to this headline">¶</a></h1>
<p>Example run command for Letsencrypt staging API environment. <strong>Does not</strong> create valid TLS certificates.</p>
<p><code class="docutils literal notranslate"><span class="pre">ansible-playbook</span> <span class="pre">example_playbook.yml</span> <span class="pre">-e</span> <span class="pre">&quot;f5cs_username=&lt;F5CS_username&gt;&quot;</span> <span class="pre">-e</span> <span class="pre">&quot;f5cs_password=&lt;F5CSPassword&gt;&quot;</span> <span class="pre">-e</span> <span class="pre">&quot;domain_name=&lt;www.mydomain.com&gt;&quot;</span></code></p>
<p>Example run command for Letsencrypt production API environment. This command creates valid TLS certificates:
<code class="docutils literal notranslate"><span class="pre">ansible-playbook</span> <span class="pre">example_playbook.yml</span> <span class="pre">-e</span> <span class="pre">&quot;f5cs_username=&lt;F5CS_username&gt;&quot;</span> <span class="pre">-e</span> <span class="pre">&quot;f5cs_password=&lt;F5CSPassword&gt;&quot;</span> <span class="pre">-e</span> <span class="pre">&quot;domain_name=&lt;www.mydomain.com&gt;&quot;</span> <span class="pre">-e</span> <span class="pre">&quot;acme_directory_target=prod&quot;</span></code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This role will create a folder structure to store letsencrypt account key, certificate, key, CA certificate and csr.</p>
</div>
</div>
<div class="section" id="example-ansible-environment">
<h1>Example Ansible environment:<a class="headerlink" href="#example-ansible-environment" title="Permalink to this headline">¶</a></h1>
<p>An example ansible environment can be here: <a class="reference external" href="https://github.com/jmcalalang/f5-tls-automation/tree/main/code/letsencrypt/example_ansible_env">Ansible Environment</a></p>
</div>



     <div class="row next-prev-btn-row">
       <div class="col-lg-12">

        <a href="../postman/postman.html" title="BIG-IP - Postman Collection" accesskey="p" class="btn btn-primary pull-left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>


          <a href="../terraform/bigipprovider/terraform.html" title="BIG-IP - Terraform Provider" accesskey="n" class="btn btn-primary pull-right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>

     </div>
     </div>


    </article>
  </div>

</div>


  <div id="clouddocs-footer"></div>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->

  <script src="../../_static/js/bootstrap.min.js"></script>
  <script src="../../_static/js/clouddocs.js"></script>
  </body>
</html>
